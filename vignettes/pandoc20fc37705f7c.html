<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Alexander Fischer" />


<title>fwildclusterboot</title>

<script>// Hide empty <a> tag within highlighted CodeBlock for screen reader accessibility (see https://github.com/jgm/pandoc/issues/6352#issuecomment-626106786) -->
// v0.0.1
// Written by JooYoung Seo (jooyoung@psu.edu) and Atsushi Yasumoto on June 1st, 2020.

document.addEventListener('DOMContentLoaded', function() {
  const codeList = document.getElementsByClassName("sourceCode");
  for (var i = 0; i < codeList.length; i++) {
    var linkList = codeList[i].getElementsByTagName('a');
    for (var j = 0; j < linkList.length; j++) {
      if (linkList[j].innerHTML === "") {
        linkList[j].setAttribute('aria-hidden', 'true');
      }
    }
  }
});
</script>
<script>$(document).ready(function(){
    if (typeof $('[data-toggle="tooltip"]').tooltip === 'function') {
        $('[data-toggle="tooltip"]').tooltip();
    }
    if ($('[data-toggle="popover"]').popover === 'function') {
        $('[data-toggle="popover"]').popover();
    }
});
</script>
<style type="text/css">
.lightable-minimal {
border-collapse: separate;
border-spacing: 16px 1px;
width: 100%;
margin-bottom: 10px;
}
.lightable-minimal td {
margin-left: 5px;
margin-right: 5px;
}
.lightable-minimal th {
margin-left: 5px;
margin-right: 5px;
}
.lightable-minimal thead tr:last-child th {
border-bottom: 2px solid #00000050;
empty-cells: hide;
}
.lightable-minimal tbody tr:first-child td {
padding-top: 0.5em;
}
.lightable-minimal.lightable-hover tbody tr:hover {
background-color: #f5f5f5;
}
.lightable-minimal.lightable-striped tbody tr:nth-child(even) {
background-color: #f5f5f5;
}
.lightable-classic {
border-top: 0.16em solid #111111;
border-bottom: 0.16em solid #111111;
width: 100%;
margin-bottom: 10px;
margin: 10px 5px;
}
.lightable-classic tfoot tr td {
border: 0;
}
.lightable-classic tfoot tr:first-child td {
border-top: 0.14em solid #111111;
}
.lightable-classic caption {
color: #222222;
}
.lightable-classic td {
padding-left: 5px;
padding-right: 5px;
color: #222222;
}
.lightable-classic th {
padding-left: 5px;
padding-right: 5px;
font-weight: normal;
color: #222222;
}
.lightable-classic thead tr:last-child th {
border-bottom: 0.10em solid #111111;
}
.lightable-classic.lightable-hover tbody tr:hover {
background-color: #F9EEC1;
}
.lightable-classic.lightable-striped tbody tr:nth-child(even) {
background-color: #f5f5f5;
}
.lightable-classic-2 {
border-top: 3px double #111111;
border-bottom: 3px double #111111;
width: 100%;
margin-bottom: 10px;
}
.lightable-classic-2 tfoot tr td {
border: 0;
}
.lightable-classic-2 tfoot tr:first-child td {
border-top: 3px double #111111;
}
.lightable-classic-2 caption {
color: #222222;
}
.lightable-classic-2 td {
padding-left: 5px;
padding-right: 5px;
color: #222222;
}
.lightable-classic-2 th {
padding-left: 5px;
padding-right: 5px;
font-weight: normal;
color: #222222;
}
.lightable-classic-2 tbody tr:last-child td {
border-bottom: 3px double #111111;
}
.lightable-classic-2 thead tr:last-child th {
border-bottom: 1px solid #111111;
}
.lightable-classic-2.lightable-hover tbody tr:hover {
background-color: #F9EEC1;
}
.lightable-classic-2.lightable-striped tbody tr:nth-child(even) {
background-color: #f5f5f5;
}
.lightable-material {
min-width: 100%;
white-space: nowrap;
table-layout: fixed;
font-family: Roboto, sans-serif;
border: 1px solid #EEE;
border-collapse: collapse;
margin-bottom: 10px;
}
.lightable-material tfoot tr td {
border: 0;
}
.lightable-material tfoot tr:first-child td {
border-top: 1px solid #EEE;
}
.lightable-material th {
height: 56px;
padding-left: 16px;
padding-right: 16px;
}
.lightable-material td {
height: 52px;
padding-left: 16px;
padding-right: 16px;
border-top: 1px solid #eeeeee;
}
.lightable-material.lightable-hover tbody tr:hover {
background-color: #f5f5f5;
}
.lightable-material.lightable-striped tbody tr:nth-child(even) {
background-color: #f5f5f5;
}
.lightable-material.lightable-striped tbody td {
border: 0;
}
.lightable-material.lightable-striped thead tr:last-child th {
border-bottom: 1px solid #ddd;
}
.lightable-material-dark {
min-width: 100%;
white-space: nowrap;
table-layout: fixed;
font-family: Roboto, sans-serif;
border: 1px solid #FFFFFF12;
border-collapse: collapse;
margin-bottom: 10px;
background-color: #363640;
}
.lightable-material-dark tfoot tr td {
border: 0;
}
.lightable-material-dark tfoot tr:first-child td {
border-top: 1px solid #FFFFFF12;
}
.lightable-material-dark th {
height: 56px;
padding-left: 16px;
padding-right: 16px;
color: #FFFFFF60;
}
.lightable-material-dark td {
height: 52px;
padding-left: 16px;
padding-right: 16px;
color: #FFFFFF;
border-top: 1px solid #FFFFFF12;
}
.lightable-material-dark.lightable-hover tbody tr:hover {
background-color: #FFFFFF12;
}
.lightable-material-dark.lightable-striped tbody tr:nth-child(even) {
background-color: #FFFFFF12;
}
.lightable-material-dark.lightable-striped tbody td {
border: 0;
}
.lightable-material-dark.lightable-striped thead tr:last-child th {
border-bottom: 1px solid #FFFFFF12;
}
.lightable-paper {
width: 100%;
margin-bottom: 10px;
color: #444;
}
.lightable-paper tfoot tr td {
border: 0;
}
.lightable-paper tfoot tr:first-child td {
border-top: 1px solid #00000020;
}
.lightable-paper thead tr:last-child th {
color: #666;
vertical-align: bottom;
border-bottom: 1px solid #00000020;
line-height: 1.15em;
padding: 10px 5px;
}
.lightable-paper td {
vertical-align: middle;
border-bottom: 1px solid #00000010;
line-height: 1.15em;
padding: 7px 5px;
}
.lightable-paper.lightable-hover tbody tr:hover {
background-color: #F9EEC1;
}
.lightable-paper.lightable-striped tbody tr:nth-child(even) {
background-color: #00000008;
}
.lightable-paper.lightable-striped tbody td {
border: 0;
}
</style>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">fwildclusterboot</h1>
<h4 class="author">Alexander Fischer</h4>



<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="kw">library</span>(fwildclusterboot)</span></code></pre></div>
<p>The <code>fwildclusterboot</code> package is an R port of STATA’s <a href="https://github.com/droodman/boottest">boottest</a> package.</p>
<p>It implements the “fast” wild cluster bootstrap algorithm developed in Roodman et al (2019) for regression objects in R. The “fast” algorithm makes it feasible to calculate test statistics based on a large number of bootstrap draws even for large samples - as long as the number of bootstrapping clusters is not too large.</p>
<p>A description of the algorithm is beyond the scope of this vignette. It is very clearly presented in <a href="https://econpapers.repec.org/paper/qedwpaper/1406.htm">Roodman et al. (2019)</a>. For technical details of the implementation in <code>fwildclusterboot</code>, have a look at the <code>technical vignette</code>.</p>
<p>For linear regression models, <code>fwildclusterboot</code> supports almost all features of <code>boottest</code>. This means that a set of different bootstrap distributions, regression weights, fixed effects, and both restricted (WCR) and unrestricted (WCU) boostrap inference are supported. The main difference is that it currently only supports univariate hypothesis tests of regression paramters of the form <span class="math inline">\(H_{0}: \beta_{k} = \beta_{k}^{0}\)</span> vs <span class="math inline">\(H_{1}: \beta_{k} \neq \beta_{k}^{0}\)</span>.</p>
<p>In contrast to <code>boottest</code>, <code>fwildclusterboot</code> does not support methods for instrumental variable estimation and the score bootstrap for non-linear models.</p>
<div id="the-boottest-function" class="section level1">
<h1>The <code>boottest()</code> function</h1>
<p>The <code>fwildclusterboot</code> package consists of one key function, <code>boottest()</code>. It implements the fast wild bootstrap and works with regression objects of type <code>lm</code>, <code>felm</code> and <code>fixest</code> from base R and the <code>lfe</code> and <code>fixest</code> packages.</p>
<p>To start, we create a random data set with two cluster variables (group_id1 &amp; group_id2), two fixed effects and a set of covariates. The <code>icc_</code> arguments control the cluster variable’s intra-cluster correlation.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a><span class="kw">library</span>(fixest)</span>
<span id="cb2-2"><a href="#cb2-2"></a><span class="kw">library</span>(lfe)</span>
<span id="cb2-3"><a href="#cb2-3"></a><span class="co">#&gt; Loading required package: Matrix</span></span>
<span id="cb2-4"><a href="#cb2-4"></a><span class="kw">library</span>(generics)</span>
<span id="cb2-5"><a href="#cb2-5"></a><span class="co">#&gt; </span></span>
<span id="cb2-6"><a href="#cb2-6"></a><span class="co">#&gt; Attaching package: &#39;generics&#39;</span></span>
<span id="cb2-7"><a href="#cb2-7"></a><span class="co">#&gt; The following object is masked from &#39;package:fixest&#39;:</span></span>
<span id="cb2-8"><a href="#cb2-8"></a><span class="co">#&gt; </span></span>
<span id="cb2-9"><a href="#cb2-9"></a><span class="co">#&gt;     estfun</span></span>
<span id="cb2-10"><a href="#cb2-10"></a><span class="co">#&gt; The following objects are masked from &#39;package:base&#39;:</span></span>
<span id="cb2-11"><a href="#cb2-11"></a><span class="co">#&gt; </span></span>
<span id="cb2-12"><a href="#cb2-12"></a><span class="co">#&gt;     as.difftime, as.factor, as.ordered, intersect, is.element, setdiff,</span></span>
<span id="cb2-13"><a href="#cb2-13"></a><span class="co">#&gt;     setequal, union</span></span>
<span id="cb2-14"><a href="#cb2-14"></a></span>
<span id="cb2-15"><a href="#cb2-15"></a><span class="co"># load data set voters included in fwildclusterboot</span></span>
<span id="cb2-16"><a href="#cb2-16"></a><span class="kw">data</span>(voters)</span>
<span id="cb2-17"><a href="#cb2-17"></a></span>
<span id="cb2-18"><a href="#cb2-18"></a><span class="co"># estimate the regression model via lm</span></span>
<span id="cb2-19"><a href="#cb2-19"></a>lm_fit &lt;-<span class="st"> </span><span class="kw">lm</span>(proposition_vote <span class="op">~</span><span class="st"> </span>treatment <span class="op">+</span><span class="st"> </span>ideology1 <span class="op">+</span><span class="st"> </span>log_income <span class="op">+</span><span class="st"> </span>Q1_immigration , <span class="dt">data =</span> voters)</span>
<span id="cb2-20"><a href="#cb2-20"></a></span>
<span id="cb2-21"><a href="#cb2-21"></a><span class="co"># estimate the regression model via feols</span></span>
<span id="cb2-22"><a href="#cb2-22"></a>feols_fit &lt;-<span class="st"> </span><span class="kw">feols</span>(proposition_vote <span class="op">~</span><span class="st"> </span>treatment <span class="op">+</span><span class="st"> </span>ideology1 <span class="op">+</span><span class="st"> </span>log_income <span class="op">+</span><span class="st"> </span>Q1_immigration , <span class="dt">data =</span> voters)</span>
<span id="cb2-23"><a href="#cb2-23"></a></span>
<span id="cb2-24"><a href="#cb2-24"></a><span class="co"># estimate the regression model via felm</span></span>
<span id="cb2-25"><a href="#cb2-25"></a>felm_fit &lt;-<span class="st"> </span><span class="kw">felm</span>(proposition_vote <span class="op">~</span><span class="st"> </span>treatment <span class="op">+</span><span class="st"> </span>ideology1 <span class="op">+</span><span class="st"> </span>log_income <span class="op">+</span><span class="st"> </span>Q1_immigration , <span class="dt">data =</span> voters)</span>
<span id="cb2-26"><a href="#cb2-26"></a></span>
<span id="cb2-27"><a href="#cb2-27"></a><span class="co"># model with interaction</span></span>
<span id="cb2-28"><a href="#cb2-28"></a>lm_fit_interact &lt;-<span class="st"> </span><span class="kw">lm</span>(proposition_vote <span class="op">~</span><span class="st"> </span>treatment <span class="op">+</span><span class="st"> </span>ideology1 <span class="op">+</span><span class="st"> </span>log_income<span class="op">:</span>Q1_immigration , <span class="dt">data =</span> voters)</span></code></pre></div>
<p>The <code>boottest()</code> function has 4 required and several optional arguments. The required objects are</p>
<ul>
<li>object: a regression object of type <code>lm</code>, <code>fixest</code> or <code>felm</code></li>
<li>clustid: a character vector that defines the clustering variables</li>
<li>param: a character vector of length one - the model parameter to be tested</li>
<li>B: the number of bootstrap iterations</li>
</ul>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a><span class="co"># boottest on an object of type lm</span></span>
<span id="cb3-2"><a href="#cb3-2"></a>boot_lm &lt;-<span class="st"> </span><span class="kw">boottest</span>(lm_fit, <span class="dt">clustid =</span> <span class="st">&quot;group_id1&quot;</span>, <span class="dt">param =</span> <span class="st">&quot;treatment&quot;</span>, <span class="dt">B =</span> <span class="dv">9999</span>)</span>
<span id="cb3-3"><a href="#cb3-3"></a><span class="co"># boottest on an object of type fixest</span></span>
<span id="cb3-4"><a href="#cb3-4"></a>boot_feols &lt;-<span class="st"> </span><span class="kw">boottest</span>(feols_fit, <span class="dt">clustid =</span> <span class="st">&quot;group_id1&quot;</span>, <span class="dt">param =</span> <span class="st">&quot;treatment&quot;</span>, <span class="dt">B =</span> <span class="dv">9999</span>)</span>
<span id="cb3-5"><a href="#cb3-5"></a><span class="co"># boottest on an object of type felm</span></span>
<span id="cb3-6"><a href="#cb3-6"></a>boot_felm &lt;-<span class="st"> </span><span class="kw">boottest</span>(felm_fit, <span class="dt">clustid =</span> <span class="st">&quot;group_id1&quot;</span>, <span class="dt">param =</span> <span class="st">&quot;treatment&quot;</span>, <span class="dt">B =</span> <span class="dv">9999</span>)</span></code></pre></div>
<p>To tests for an interaction, it is important to use the coefficient names that are internally created by the modeling function.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a><span class="kw">names</span>(<span class="kw">coef</span>(lm_fit_interact))</span>
<span id="cb4-2"><a href="#cb4-2"></a><span class="co">#&gt;  [1] &quot;(Intercept)&quot;                 &quot;treatment&quot;                  </span></span>
<span id="cb4-3"><a href="#cb4-3"></a><span class="co">#&gt;  [3] &quot;ideology1&quot;                   &quot;log_income:Q1_immigration1&quot; </span></span>
<span id="cb4-4"><a href="#cb4-4"></a><span class="co">#&gt;  [5] &quot;log_income:Q1_immigration2&quot;  &quot;log_income:Q1_immigration3&quot; </span></span>
<span id="cb4-5"><a href="#cb4-5"></a><span class="co">#&gt;  [7] &quot;log_income:Q1_immigration4&quot;  &quot;log_income:Q1_immigration5&quot; </span></span>
<span id="cb4-6"><a href="#cb4-6"></a><span class="co">#&gt;  [9] &quot;log_income:Q1_immigration6&quot;  &quot;log_income:Q1_immigration7&quot; </span></span>
<span id="cb4-7"><a href="#cb4-7"></a><span class="co">#&gt; [11] &quot;log_income:Q1_immigration8&quot;  &quot;log_income:Q1_immigration9&quot; </span></span>
<span id="cb4-8"><a href="#cb4-8"></a><span class="co">#&gt; [13] &quot;log_income:Q1_immigration10&quot;</span></span>
<span id="cb4-9"><a href="#cb4-9"></a>boot_lm_interact &lt;-<span class="st"> </span><span class="kw">boottest</span>(lm_fit_interact, <span class="dt">clustid =</span> <span class="st">&quot;group_id1&quot;</span>, <span class="dt">param =</span> <span class="st">&quot;log_income:Q1_immigration1&quot;</span>, <span class="dt">B =</span> <span class="dv">9999</span>)</span></code></pre></div>
<p>To access the estimation results, <code>boottest()</code> comes with <code>summary()</code> and <code>tidy()</code> methods. The <code>tidy</code> method returns the estimation results in a data.frame. <code>summary()</code> returns some additional information on top of the test statistics reported by <code>tidy()</code>.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a><span class="kw">tidy</span>(boot_lm)</span>
<span id="cb5-2"><a href="#cb5-2"></a><span class="co">#&gt;                term   estimate statistic    p.value   conf.low conf.high</span></span>
<span id="cb5-3"><a href="#cb5-3"></a><span class="co">#&gt; treatment treatment 0.07290769   3.78619 0.00070007 0.03347748 0.1132493</span></span>
<span id="cb5-4"><a href="#cb5-4"></a><span class="kw">summary</span>(boot_lm)</span>
<span id="cb5-5"><a href="#cb5-5"></a><span class="co">#&gt; boottest.lm(object = lm_fit, clustid = &quot;group_id1&quot;, param = &quot;treatment&quot;, </span></span>
<span id="cb5-6"><a href="#cb5-6"></a><span class="co">#&gt;     B = 9999)</span></span>
<span id="cb5-7"><a href="#cb5-7"></a><span class="co">#&gt;  </span></span>
<span id="cb5-8"><a href="#cb5-8"></a><span class="co">#&gt;  Observations: 300</span></span>
<span id="cb5-9"><a href="#cb5-9"></a><span class="co">#&gt;  Bootstr. Iter: 9999</span></span>
<span id="cb5-10"><a href="#cb5-10"></a><span class="co">#&gt;  Bootstr. Type: rademacher</span></span>
<span id="cb5-11"><a href="#cb5-11"></a><span class="co">#&gt;  Clustering: oneway</span></span>
<span id="cb5-12"><a href="#cb5-12"></a><span class="co">#&gt;  Confidence Sets: 95%</span></span>
<span id="cb5-13"><a href="#cb5-13"></a><span class="co">#&gt;  Number of Clusters: 40</span></span>
<span id="cb5-14"><a href="#cb5-14"></a><span class="co">#&gt; </span></span>
<span id="cb5-15"><a href="#cb5-15"></a><span class="co">#&gt;        term estimate statistic p.value conf.low conf.high</span></span>
<span id="cb5-16"><a href="#cb5-16"></a><span class="co">#&gt; 1 treatment    0.073     3.786   0.001    0.033     0.113</span></span></code></pre></div>
<p>A <code>plot()</code> method allows the user to inspect the bootstrap t-statistics:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a><span class="kw">plot</span>(boot_lm)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<!-- A note on the output in `tidy()` and `summary()`: -->
<div id="multiway-clustering" class="section level2">
<h2>Multiway Clustering</h2>
<p>The <code>boottest()</code> function supports clustering of any dimension. E.g. for two-way clustering, one simply needs to specify the names of the cluster variables in a character vector.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a>boot_lm &lt;-<span class="st"> </span><span class="kw">boottest</span>(lm_fit, <span class="dt">clustid =</span> <span class="kw">c</span>(<span class="st">&quot;group_id1&quot;</span>, <span class="st">&quot;group_id2&quot;</span>), <span class="dt">param =</span> <span class="st">&quot;treatment&quot;</span>, <span class="dt">B =</span> <span class="dv">9999</span>)</span>
<span id="cb7-2"><a href="#cb7-2"></a><span class="kw">summary</span>(boot_lm)</span>
<span id="cb7-3"><a href="#cb7-3"></a><span class="co">#&gt; boottest.lm(object = lm_fit, clustid = c(&quot;group_id1&quot;, &quot;group_id2&quot;), </span></span>
<span id="cb7-4"><a href="#cb7-4"></a><span class="co">#&gt;     param = &quot;treatment&quot;, B = 9999)</span></span>
<span id="cb7-5"><a href="#cb7-5"></a><span class="co">#&gt;  </span></span>
<span id="cb7-6"><a href="#cb7-6"></a><span class="co">#&gt;  Observations: 300</span></span>
<span id="cb7-7"><a href="#cb7-7"></a><span class="co">#&gt;  Bootstr. Iter: 9999</span></span>
<span id="cb7-8"><a href="#cb7-8"></a><span class="co">#&gt;  Bootstr. Type: rademacher</span></span>
<span id="cb7-9"><a href="#cb7-9"></a><span class="co">#&gt;  Clustering: twoway</span></span>
<span id="cb7-10"><a href="#cb7-10"></a><span class="co">#&gt;  Confidence Sets: 95%</span></span>
<span id="cb7-11"><a href="#cb7-11"></a><span class="co">#&gt;  Number of Clusters: 40 20 251</span></span>
<span id="cb7-12"><a href="#cb7-12"></a><span class="co">#&gt; </span></span>
<span id="cb7-13"><a href="#cb7-13"></a><span class="co">#&gt;        term estimate statistic p.value conf.low conf.high</span></span>
<span id="cb7-14"><a href="#cb7-14"></a><span class="co">#&gt; 1 treatment    0.073     3.925   0.004    0.031     0.115</span></span></code></pre></div>
</div>
<div id="choice-of-bootstrap-weights" class="section level2">
<h2>Choice of Bootstrap Weights</h2>
<p>Furthermore, the user can choose among four different weighting distribution via the <code>type</code> argument: Rademacher, Mammen, Normal and Webb. By default, <code>boottest()</code> uses the Rademacher distribution.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a>boot_lm_rade &lt;-<span class="st"> </span><span class="kw">boottest</span>(lm_fit, </span>
<span id="cb8-2"><a href="#cb8-2"></a>                    <span class="dt">clustid =</span> <span class="kw">c</span>(<span class="st">&quot;group_id1&quot;</span>, <span class="st">&quot;group_id2&quot;</span>), </span>
<span id="cb8-3"><a href="#cb8-3"></a>                    <span class="dt">param =</span> <span class="st">&quot;treatment&quot;</span>, </span>
<span id="cb8-4"><a href="#cb8-4"></a>                    <span class="dt">B =</span> <span class="dv">9999</span>,</span>
<span id="cb8-5"><a href="#cb8-5"></a>                    <span class="dt">type =</span> <span class="st">&quot;rademacher&quot;</span>)</span>
<span id="cb8-6"><a href="#cb8-6"></a>boot_lm_webb &lt;-<span class="st"> </span><span class="kw">boottest</span>(lm_fit, </span>
<span id="cb8-7"><a href="#cb8-7"></a>                    <span class="dt">clustid =</span> <span class="kw">c</span>(<span class="st">&quot;group_id1&quot;</span>, <span class="st">&quot;group_id2&quot;</span>), </span>
<span id="cb8-8"><a href="#cb8-8"></a>                    <span class="dt">param =</span> <span class="st">&quot;treatment&quot;</span>, </span>
<span id="cb8-9"><a href="#cb8-9"></a>                    <span class="dt">B =</span> <span class="dv">9999</span>,</span>
<span id="cb8-10"><a href="#cb8-10"></a>                    <span class="dt">type =</span> <span class="st">&quot;webb&quot;</span>)</span>
<span id="cb8-11"><a href="#cb8-11"></a></span>
<span id="cb8-12"><a href="#cb8-12"></a><span class="kw">summary</span>(boot_lm_rade)</span>
<span id="cb8-13"><a href="#cb8-13"></a><span class="co">#&gt; boottest.lm(object = lm_fit, clustid = c(&quot;group_id1&quot;, &quot;group_id2&quot;), </span></span>
<span id="cb8-14"><a href="#cb8-14"></a><span class="co">#&gt;     param = &quot;treatment&quot;, B = 9999, type = &quot;rademacher&quot;)</span></span>
<span id="cb8-15"><a href="#cb8-15"></a><span class="co">#&gt;  </span></span>
<span id="cb8-16"><a href="#cb8-16"></a><span class="co">#&gt;  Observations: 300</span></span>
<span id="cb8-17"><a href="#cb8-17"></a><span class="co">#&gt;  Bootstr. Iter: 9999</span></span>
<span id="cb8-18"><a href="#cb8-18"></a><span class="co">#&gt;  Bootstr. Type: rademacher</span></span>
<span id="cb8-19"><a href="#cb8-19"></a><span class="co">#&gt;  Clustering: twoway</span></span>
<span id="cb8-20"><a href="#cb8-20"></a><span class="co">#&gt;  Confidence Sets: 95%</span></span>
<span id="cb8-21"><a href="#cb8-21"></a><span class="co">#&gt;  Number of Clusters: 40 20 251</span></span>
<span id="cb8-22"><a href="#cb8-22"></a><span class="co">#&gt; </span></span>
<span id="cb8-23"><a href="#cb8-23"></a><span class="co">#&gt;        term estimate statistic p.value conf.low conf.high</span></span>
<span id="cb8-24"><a href="#cb8-24"></a><span class="co">#&gt; 1 treatment    0.073     3.925   0.005    0.031     0.115</span></span>
<span id="cb8-25"><a href="#cb8-25"></a><span class="kw">summary</span>(boot_lm_webb)</span>
<span id="cb8-26"><a href="#cb8-26"></a><span class="co">#&gt; boottest.lm(object = lm_fit, clustid = c(&quot;group_id1&quot;, &quot;group_id2&quot;), </span></span>
<span id="cb8-27"><a href="#cb8-27"></a><span class="co">#&gt;     param = &quot;treatment&quot;, B = 9999, type = &quot;webb&quot;)</span></span>
<span id="cb8-28"><a href="#cb8-28"></a><span class="co">#&gt;  </span></span>
<span id="cb8-29"><a href="#cb8-29"></a><span class="co">#&gt;  Observations: 300</span></span>
<span id="cb8-30"><a href="#cb8-30"></a><span class="co">#&gt;  Bootstr. Iter: 9999</span></span>
<span id="cb8-31"><a href="#cb8-31"></a><span class="co">#&gt;  Bootstr. Type: webb</span></span>
<span id="cb8-32"><a href="#cb8-32"></a><span class="co">#&gt;  Clustering: twoway</span></span>
<span id="cb8-33"><a href="#cb8-33"></a><span class="co">#&gt;  Confidence Sets: 95%</span></span>
<span id="cb8-34"><a href="#cb8-34"></a><span class="co">#&gt;  Number of Clusters: 40 20 251</span></span>
<span id="cb8-35"><a href="#cb8-35"></a><span class="co">#&gt; </span></span>
<span id="cb8-36"><a href="#cb8-36"></a><span class="co">#&gt;        term estimate statistic p.value conf.low conf.high</span></span>
<span id="cb8-37"><a href="#cb8-37"></a><span class="co">#&gt; 1 treatment    0.073     3.925   0.004    0.031     0.115</span></span></code></pre></div>
</div>
<div id="other-function-arguments" class="section level2">
<h2>Other function arguments</h2>
<p>Via the function argument <code>sign_level</code>, the user can control the significance level of the test. The default value is sign_level = 0.05, which corresponds to a 95% confindence interval.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a>boot_lm_<span class="dv">5</span> &lt;-<span class="st"> </span><span class="kw">boottest</span>(lm_fit, </span>
<span id="cb9-2"><a href="#cb9-2"></a>                    <span class="dt">clustid =</span> <span class="kw">c</span>(<span class="st">&quot;group_id1&quot;</span>),</span>
<span id="cb9-3"><a href="#cb9-3"></a>                    <span class="dt">param =</span> <span class="st">&quot;treatment&quot;</span>, <span class="dt">B =</span> <span class="dv">9999</span>, </span>
<span id="cb9-4"><a href="#cb9-4"></a>                    <span class="dt">sign_level =</span> <span class="fl">0.05</span>)</span>
<span id="cb9-5"><a href="#cb9-5"></a>boot_lm_<span class="dv">10</span> &lt;-<span class="st"> </span><span class="kw">boottest</span>(lm_fit, </span>
<span id="cb9-6"><a href="#cb9-6"></a>                    <span class="dt">clustid =</span> <span class="kw">c</span>(<span class="st">&quot;group_id1&quot;</span>),</span>
<span id="cb9-7"><a href="#cb9-7"></a>                    <span class="dt">param =</span> <span class="st">&quot;treatment&quot;</span>, <span class="dt">B =</span> <span class="dv">9999</span>, </span>
<span id="cb9-8"><a href="#cb9-8"></a>                    <span class="dt">sign_level =</span> <span class="fl">0.10</span>)</span>
<span id="cb9-9"><a href="#cb9-9"></a><span class="kw">summary</span>(boot_lm_<span class="dv">5</span>)</span>
<span id="cb9-10"><a href="#cb9-10"></a><span class="co">#&gt; boottest.lm(object = lm_fit, clustid = c(&quot;group_id1&quot;), param = &quot;treatment&quot;, </span></span>
<span id="cb9-11"><a href="#cb9-11"></a><span class="co">#&gt;     B = 9999, sign_level = 0.05)</span></span>
<span id="cb9-12"><a href="#cb9-12"></a><span class="co">#&gt;  </span></span>
<span id="cb9-13"><a href="#cb9-13"></a><span class="co">#&gt;  Observations: 300</span></span>
<span id="cb9-14"><a href="#cb9-14"></a><span class="co">#&gt;  Bootstr. Iter: 9999</span></span>
<span id="cb9-15"><a href="#cb9-15"></a><span class="co">#&gt;  Bootstr. Type: rademacher</span></span>
<span id="cb9-16"><a href="#cb9-16"></a><span class="co">#&gt;  Clustering: oneway</span></span>
<span id="cb9-17"><a href="#cb9-17"></a><span class="co">#&gt;  Confidence Sets: 95%</span></span>
<span id="cb9-18"><a href="#cb9-18"></a><span class="co">#&gt;  Number of Clusters: 40</span></span>
<span id="cb9-19"><a href="#cb9-19"></a><span class="co">#&gt; </span></span>
<span id="cb9-20"><a href="#cb9-20"></a><span class="co">#&gt;        term estimate statistic p.value conf.low conf.high</span></span>
<span id="cb9-21"><a href="#cb9-21"></a><span class="co">#&gt; 1 treatment    0.073     3.786   0.001    0.033     0.113</span></span>
<span id="cb9-22"><a href="#cb9-22"></a><span class="kw">summary</span>(boot_lm_<span class="dv">10</span>)</span>
<span id="cb9-23"><a href="#cb9-23"></a><span class="co">#&gt; boottest.lm(object = lm_fit, clustid = c(&quot;group_id1&quot;), param = &quot;treatment&quot;, </span></span>
<span id="cb9-24"><a href="#cb9-24"></a><span class="co">#&gt;     B = 9999, sign_level = 0.1)</span></span>
<span id="cb9-25"><a href="#cb9-25"></a><span class="co">#&gt;  </span></span>
<span id="cb9-26"><a href="#cb9-26"></a><span class="co">#&gt;  Observations: 300</span></span>
<span id="cb9-27"><a href="#cb9-27"></a><span class="co">#&gt;  Bootstr. Iter: 9999</span></span>
<span id="cb9-28"><a href="#cb9-28"></a><span class="co">#&gt;  Bootstr. Type: rademacher</span></span>
<span id="cb9-29"><a href="#cb9-29"></a><span class="co">#&gt;  Clustering: oneway</span></span>
<span id="cb9-30"><a href="#cb9-30"></a><span class="co">#&gt;  Confidence Sets: 90%</span></span>
<span id="cb9-31"><a href="#cb9-31"></a><span class="co">#&gt;  Number of Clusters: 40</span></span>
<span id="cb9-32"><a href="#cb9-32"></a><span class="co">#&gt; </span></span>
<span id="cb9-33"><a href="#cb9-33"></a><span class="co">#&gt;        term estimate statistic p.value conf.low conf.high</span></span>
<span id="cb9-34"><a href="#cb9-34"></a><span class="co">#&gt; 1 treatment    0.073     3.786   0.001     0.04     0.106</span></span></code></pre></div>
<p>In the case of multiway clustering, the user might want to specify the bootstrap clustering level. By default, boottest chooses the clustering level with the highest number of clusters as <code>bootcluster = &quot;max&quot;</code>. Other choices are the minimum cluster, or independent clustering variables.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a>boot_lm &lt;-<span class="st"> </span><span class="kw">boottest</span>(lm_fit, </span>
<span id="cb10-2"><a href="#cb10-2"></a>                    <span class="dt">clustid =</span> <span class="kw">c</span>(<span class="st">&quot;group_id1&quot;</span>, <span class="st">&quot;group_id2&quot;</span>), </span>
<span id="cb10-3"><a href="#cb10-3"></a>                    <span class="dt">param =</span> <span class="st">&quot;treatment&quot;</span>,</span>
<span id="cb10-4"><a href="#cb10-4"></a>                    <span class="dt">B =</span> <span class="dv">9999</span>, </span>
<span id="cb10-5"><a href="#cb10-5"></a>                    <span class="dt">bootcluster =</span> <span class="st">&quot;min&quot;</span>)</span>
<span id="cb10-6"><a href="#cb10-6"></a><span class="kw">summary</span>(boot_lm)</span>
<span id="cb10-7"><a href="#cb10-7"></a><span class="co">#&gt; boottest.lm(object = lm_fit, clustid = c(&quot;group_id1&quot;, &quot;group_id2&quot;), </span></span>
<span id="cb10-8"><a href="#cb10-8"></a><span class="co">#&gt;     param = &quot;treatment&quot;, B = 9999, bootcluster = &quot;min&quot;)</span></span>
<span id="cb10-9"><a href="#cb10-9"></a><span class="co">#&gt;  </span></span>
<span id="cb10-10"><a href="#cb10-10"></a><span class="co">#&gt;  Observations: 300</span></span>
<span id="cb10-11"><a href="#cb10-11"></a><span class="co">#&gt;  Bootstr. Iter: 9999</span></span>
<span id="cb10-12"><a href="#cb10-12"></a><span class="co">#&gt;  Bootstr. Type: rademacher</span></span>
<span id="cb10-13"><a href="#cb10-13"></a><span class="co">#&gt;  Clustering: twoway</span></span>
<span id="cb10-14"><a href="#cb10-14"></a><span class="co">#&gt;  Confidence Sets: 95%</span></span>
<span id="cb10-15"><a href="#cb10-15"></a><span class="co">#&gt;  Number of Clusters: 40 20 251</span></span>
<span id="cb10-16"><a href="#cb10-16"></a><span class="co">#&gt; </span></span>
<span id="cb10-17"><a href="#cb10-17"></a><span class="co">#&gt;        term estimate statistic p.value conf.low conf.high</span></span>
<span id="cb10-18"><a href="#cb10-18"></a><span class="co">#&gt; 1 treatment    0.073     3.925   0.005    0.031     0.111</span></span>
<span id="cb10-19"><a href="#cb10-19"></a></span>
<span id="cb10-20"><a href="#cb10-20"></a>boot_lm &lt;-<span class="st"> </span><span class="kw">boottest</span>(lm_fit, </span>
<span id="cb10-21"><a href="#cb10-21"></a>                    <span class="dt">clustid =</span> <span class="kw">c</span>(<span class="st">&quot;group_id1&quot;</span>, <span class="st">&quot;group_id2&quot;</span>), </span>
<span id="cb10-22"><a href="#cb10-22"></a>                    <span class="dt">param =</span> <span class="st">&quot;treatment&quot;</span>,</span>
<span id="cb10-23"><a href="#cb10-23"></a>                    <span class="dt">B =</span> <span class="dv">9999</span>, </span>
<span id="cb10-24"><a href="#cb10-24"></a>                    <span class="dt">bootcluster =</span> <span class="st">&quot;group_id1&quot;</span>)</span>
<span id="cb10-25"><a href="#cb10-25"></a><span class="kw">summary</span>(boot_lm)</span>
<span id="cb10-26"><a href="#cb10-26"></a><span class="co">#&gt; boottest.lm(object = lm_fit, clustid = c(&quot;group_id1&quot;, &quot;group_id2&quot;), </span></span>
<span id="cb10-27"><a href="#cb10-27"></a><span class="co">#&gt;     param = &quot;treatment&quot;, B = 9999, bootcluster = &quot;group_id1&quot;)</span></span>
<span id="cb10-28"><a href="#cb10-28"></a><span class="co">#&gt;  </span></span>
<span id="cb10-29"><a href="#cb10-29"></a><span class="co">#&gt;  Observations: 300</span></span>
<span id="cb10-30"><a href="#cb10-30"></a><span class="co">#&gt;  Bootstr. Iter: 9999</span></span>
<span id="cb10-31"><a href="#cb10-31"></a><span class="co">#&gt;  Bootstr. Type: rademacher</span></span>
<span id="cb10-32"><a href="#cb10-32"></a><span class="co">#&gt;  Clustering: twoway</span></span>
<span id="cb10-33"><a href="#cb10-33"></a><span class="co">#&gt;  Confidence Sets: 95%</span></span>
<span id="cb10-34"><a href="#cb10-34"></a><span class="co">#&gt;  Number of Clusters: 40 20 251</span></span>
<span id="cb10-35"><a href="#cb10-35"></a><span class="co">#&gt; </span></span>
<span id="cb10-36"><a href="#cb10-36"></a><span class="co">#&gt;        term estimate statistic p.value conf.low conf.high</span></span>
<span id="cb10-37"><a href="#cb10-37"></a><span class="co">#&gt; 1 treatment    0.073     3.925   0.008    0.028     0.116</span></span></code></pre></div>
</div>
<div id="fixed-effects" class="section level2">
<h2>Fixed Effects</h2>
<p>Last, <code>boottest()</code> supports out-projection of fixed effects in the estimation stage via <code>lfe::felm()</code> and <code>fixest::feols()</code>. Within the bootstrap, the user can choose to project out <em>only one</em> fixed effect, which can be set via the <code>fe</code> function argument. All other fixed effects specified in either <code>felm()</code> or <code>feols()</code> are treated as sets of binary regressors.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a><span class="co"># estimate the regression model via feols</span></span>
<span id="cb11-2"><a href="#cb11-2"></a>feols_fit &lt;-<span class="st"> </span><span class="kw">feols</span>(proposition_vote <span class="op">~</span><span class="st"> </span>treatment <span class="op">+</span><span class="st"> </span>ideology1 <span class="op">+</span><span class="st"> </span>log_income <span class="op">|</span><span class="st"> </span>Q1_immigration , <span class="dt">data =</span> voters)</span>
<span id="cb11-3"><a href="#cb11-3"></a></span>
<span id="cb11-4"><a href="#cb11-4"></a><span class="co"># estimate the regression model via felm</span></span>
<span id="cb11-5"><a href="#cb11-5"></a>felm_fit &lt;-<span class="st"> </span><span class="kw">felm</span>(proposition_vote <span class="op">~</span><span class="st"> </span>treatment <span class="op">+</span><span class="st"> </span>ideology1 <span class="op">+</span><span class="st"> </span>log_income <span class="op">|</span><span class="st"> </span>Q1_immigration , <span class="dt">data =</span> voters)</span>
<span id="cb11-6"><a href="#cb11-6"></a></span>
<span id="cb11-7"><a href="#cb11-7"></a>boot_feols &lt;-<span class="st"> </span><span class="kw">boottest</span>(feols_fit, </span>
<span id="cb11-8"><a href="#cb11-8"></a>                       <span class="dt">clustid =</span> <span class="st">&quot;group_id1&quot;</span>, </span>
<span id="cb11-9"><a href="#cb11-9"></a>                       <span class="dt">param =</span> <span class="st">&quot;treatment&quot;</span>, </span>
<span id="cb11-10"><a href="#cb11-10"></a>                       <span class="dt">B =</span> <span class="dv">9999</span>, </span>
<span id="cb11-11"><a href="#cb11-11"></a>                       <span class="dt">fe =</span> <span class="st">&quot;Q1_immigration&quot;</span>)</span>
<span id="cb11-12"><a href="#cb11-12"></a></span>
<span id="cb11-13"><a href="#cb11-13"></a>boot_felm &lt;-<span class="st"> </span><span class="kw">boottest</span>(felm_fit, </span>
<span id="cb11-14"><a href="#cb11-14"></a>                      <span class="dt">clustid =</span> <span class="st">&quot;group_id1&quot;</span>,</span>
<span id="cb11-15"><a href="#cb11-15"></a>                      <span class="dt">param =</span> <span class="st">&quot;treatment&quot;</span>, </span>
<span id="cb11-16"><a href="#cb11-16"></a>                      <span class="dt">B =</span> <span class="dv">9999</span>, </span>
<span id="cb11-17"><a href="#cb11-17"></a>                      <span class="dt">fe =</span> <span class="st">&quot;Q1_immigration&quot;</span>)</span></code></pre></div>
</div>
<div id="the-subcluster-bootstrap" class="section level2">
<h2>The Subcluster Bootstrap</h2>
<p>In the case of few treated clusters, <a href="https://academic.oup.com/ectj/article-abstract/21/2/114/5078969">MacKinnon and Webb (2018)</a> suggest to use subclusters to form the bootstrap distribution. <code>boottest()</code> allows the user to specify subclusters via the <code>bootcluster</code> argument.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1"></a>boot_min &lt;-<span class="st"> </span><span class="kw">boottest</span>(lm_fit,</span>
<span id="cb12-2"><a href="#cb12-2"></a>                    <span class="dt">clustid =</span> <span class="kw">c</span>(<span class="st">&quot;group_id1&quot;</span>, <span class="st">&quot;group_id2&quot;</span>), </span>
<span id="cb12-3"><a href="#cb12-3"></a>                    <span class="dt">param =</span> <span class="st">&quot;treatment&quot;</span>, </span>
<span id="cb12-4"><a href="#cb12-4"></a>                    <span class="dt">B =</span> <span class="dv">9999</span>, </span>
<span id="cb12-5"><a href="#cb12-5"></a>                    <span class="dt">bootcluster =</span> <span class="st">&quot;min&quot;</span>)</span>
<span id="cb12-6"><a href="#cb12-6"></a>boot_var &lt;-<span class="st"> </span><span class="kw">boottest</span>(lm_fit,</span>
<span id="cb12-7"><a href="#cb12-7"></a>                    <span class="dt">clustid =</span> <span class="kw">c</span>(<span class="st">&quot;group_id1&quot;</span>, <span class="st">&quot;group_id2&quot;</span>), </span>
<span id="cb12-8"><a href="#cb12-8"></a>                    <span class="dt">param =</span> <span class="st">&quot;treatment&quot;</span>, </span>
<span id="cb12-9"><a href="#cb12-9"></a>                    <span class="dt">B =</span> <span class="dv">9999</span>, </span>
<span id="cb12-10"><a href="#cb12-10"></a>                    <span class="dt">bootcluster =</span> <span class="st">&quot;group_id1&quot;</span>)</span>
<span id="cb12-11"><a href="#cb12-11"></a>boot_2var &lt;-<span class="st"> </span><span class="kw">boottest</span>(lm_fit,</span>
<span id="cb12-12"><a href="#cb12-12"></a>                    <span class="dt">clustid =</span> <span class="kw">c</span>(<span class="st">&quot;group_id1&quot;</span>, <span class="st">&quot;group_id2&quot;</span>), </span>
<span id="cb12-13"><a href="#cb12-13"></a>                    <span class="dt">param =</span> <span class="st">&quot;treatment&quot;</span>, </span>
<span id="cb12-14"><a href="#cb12-14"></a>                    <span class="dt">B =</span> <span class="dv">9999</span>, </span>
<span id="cb12-15"><a href="#cb12-15"></a>                    <span class="dt">bootcluster =</span> <span class="kw">c</span>(<span class="st">&quot;group_id1&quot;</span>, <span class="st">&quot;Q1_immigration&quot;</span>))</span>
<span id="cb12-16"><a href="#cb12-16"></a><span class="kw">tidy</span>(boot_min)</span>
<span id="cb12-17"><a href="#cb12-17"></a><span class="co">#&gt;                term   estimate statistic    p.value   conf.low conf.high</span></span>
<span id="cb12-18"><a href="#cb12-18"></a><span class="co">#&gt; treatment treatment 0.07290769  3.924685 0.00430043 0.03210876 0.1102243</span></span>
<span id="cb12-19"><a href="#cb12-19"></a><span class="kw">tidy</span>(boot_2var)</span>
<span id="cb12-20"><a href="#cb12-20"></a><span class="co">#&gt;                term   estimate statistic     p.value   conf.low conf.high</span></span>
<span id="cb12-21"><a href="#cb12-21"></a><span class="co">#&gt; treatment treatment 0.07290769  3.924685 0.007411859 0.02772688 0.1173848</span></span></code></pre></div>
</div>
<div id="regression-weights-weighted-least-squares-wls" class="section level2">
<h2>Regression Weights / Weighted Least Squares (WLS)</h2>
<p>If regression weights are specified in the estimation stage via <code>lm()</code>, <code>feols()</code> or <code>felm()</code>, <code>boottest()</code> incorporates the weights into the bootstrap inference:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a><span class="co"># regression with weights / WLS</span></span>
<span id="cb13-2"><a href="#cb13-2"></a>feols_fit &lt;-<span class="st"> </span><span class="kw">feols</span>(proposition_vote <span class="op">~</span><span class="st"> </span>treatment <span class="op">+</span><span class="st"> </span>ideology1 <span class="op">+</span><span class="st"> </span>log_income, <span class="dt">weights =</span> voters<span class="op">$</span>weights, <span class="dt">data =</span> voters)</span>
<span id="cb13-3"><a href="#cb13-3"></a></span>
<span id="cb13-4"><a href="#cb13-4"></a>boot_feols &lt;-<span class="st"> </span><span class="kw">boottest</span>(feols_fit, </span>
<span id="cb13-5"><a href="#cb13-5"></a>                       <span class="dt">clustid =</span> <span class="st">&quot;group_id1&quot;</span>, </span>
<span id="cb13-6"><a href="#cb13-6"></a>                       <span class="dt">param =</span> <span class="st">&quot;treatment&quot;</span>, </span>
<span id="cb13-7"><a href="#cb13-7"></a>                       <span class="dt">B =</span> <span class="dv">9999</span>)</span></code></pre></div>
</div>
<div id="parallel-execution" class="section level2">
<h2>Parallel Execution</h2>
<p>A major bottleneck for the performance of <code>boottest()</code> is a large matrix multiplication, which includes the bootstrap weights matrix on the right. In order to speed up the computation, this multiplication calls the c++ Eigen library, which allows for parallelization of dense matrix products. By default, <code>boottest()</code> uses one thread. Note that there is a cost of parallelization due to communication overhead. As a rule of thumb, if <code>boottest()</code> takes more than 10 seconds per execution, using a second thread might speed up the bootstrap.</p>
<p>The number of threads can be specified via the <code>nthreads</code> argument of <code>boottest()</code>:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1"></a>boot_feols &lt;-<span class="st"> </span><span class="kw">boottest</span>(feols_fit, </span>
<span id="cb14-2"><a href="#cb14-2"></a>                       <span class="dt">clustid =</span> <span class="st">&quot;group_id1&quot;</span>, </span>
<span id="cb14-3"><a href="#cb14-3"></a>                       <span class="dt">param =</span> <span class="st">&quot;treatment&quot;</span>, </span>
<span id="cb14-4"><a href="#cb14-4"></a>                       <span class="dt">B =</span> <span class="dv">9999</span>, </span>
<span id="cb14-5"><a href="#cb14-5"></a>                       <span class="dt">nthreads =</span> <span class="dv">2</span>)</span></code></pre></div>
</div>
</div>
<div id="miscellanea" class="section level1">
<h1>Miscellanea</h1>
<div id="use-of-boottest-and-modelsummary" class="section level2">
<h2>Use of ´boottest()´ and ´modelsummary´</h2>
<p>´boottest()´ is supported by both a <code>tidy()</code> and a <code>glance()</code> methods, so it can be used with the <code>modelsummary</code> package.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a><span class="kw">library</span>(modelsummary)</span>
<span id="cb15-2"><a href="#cb15-2"></a><span class="kw">library</span>(generics)</span>
<span id="cb15-3"><a href="#cb15-3"></a></span>
<span id="cb15-4"><a href="#cb15-4"></a><span class="kw">msummary</span>(<span class="dt">model =</span> <span class="kw">list</span>(boot_lm, boot_feols, boot_felm), </span>
<span id="cb15-5"><a href="#cb15-5"></a>         <span class="dt">estimate =</span> <span class="st">&quot;{estimate} ({p.value})&quot;</span>, </span>
<span id="cb15-6"><a href="#cb15-6"></a>         <span class="dt">statistic =</span> <span class="st">&quot;[{conf.low}, {conf.high}]&quot;</span>, </span>
<span id="cb15-7"><a href="#cb15-7"></a>         <span class="dt">conf_int =</span> <span class="fl">0.05</span>)</span></code></pre></div>
<table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:center;">
Model 1
</th>
<th style="text-align:center;">
Model 2
</th>
<th style="text-align:center;">
Model 3
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
treatment
</td>
<td style="text-align:center;">
0.073 (0.008)
</td>
<td style="text-align:center;">
0.116 (0.000)
</td>
<td style="text-align:center;">
0.073 (0.001)
</td>
</tr>
<tr>
<td style="text-align:left;box-shadow: 0px 1px">
</td>
<td style="text-align:center;box-shadow: 0px 1px">
[0.028, 0.116]
</td>
<td style="text-align:center;box-shadow: 0px 1px">
[0.060, 0.171]
</td>
<td style="text-align:center;box-shadow: 0px 1px">
[0.033, 0.113]
</td>
</tr>
<tr>
<td style="text-align:left;">
Num.Obs.
</td>
<td style="text-align:center;">
300
</td>
<td style="text-align:center;">
300
</td>
<td style="text-align:center;">
300
</td>
</tr>
<tr>
<td style="text-align:left;">
R2
</td>
<td style="text-align:center;">
0.316
</td>
<td style="text-align:center;">
0.085
</td>
<td style="text-align:center;">
0.316
</td>
</tr>
<tr>
<td style="text-align:left;">
R2 Adj.
</td>
<td style="text-align:center;">
0.288
</td>
<td style="text-align:center;">
0.075
</td>
<td style="text-align:center;">
0.288
</td>
</tr>
<tr>
<td style="text-align:left;">
R2 Within
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
</td>
</tr>
<tr>
<td style="text-align:left;">
R2 Pseudo
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
</td>
</tr>
<tr>
<td style="text-align:left;">
AIC
</td>
<td style="text-align:center;">
-82.1
</td>
<td style="text-align:center;">
1.1
</td>
<td style="text-align:center;">
</td>
</tr>
<tr>
<td style="text-align:left;">
BIC
</td>
<td style="text-align:center;">
-30.2
</td>
<td style="text-align:center;">
15.9
</td>
<td style="text-align:center;">
</td>
</tr>
<tr>
<td style="text-align:left;">
Log.Lik.
</td>
<td style="text-align:center;">
55.025
</td>
<td style="text-align:center;">
3.451
</td>
<td style="text-align:center;">
</td>
</tr>
</tbody>
</table>
<!-- ## Why does `boottest()` not compute standard errors? -->
<!-- ## A note on performance -->
<!-- ## Inversion of p-values -->
<!-- ### How it works: make use of linearity of both the numerator and J -->
<!-- The starting point of this section are equations (56, 58 and 62) in Roodman et al. They show that once can write the numerator as (eq. 56) -->
<!-- $$ -->
<!--   R(\hat{\beta}^{*} - \tilde{\beta}) = \{S_{c_{*}} [WDXAR' :* \tilde{u}] \}' v^{*}. -->
<!-- $$ -->
<!-- The denominator can be written as (eq. 60) -->
<!-- $$ -->
<!-- $$ -->
<!-- where the object $K$ can be computed as  -->
<!-- $$ -->
<!-- $$ -->
<!-- For univariate hypotheses, both numerator and J are linear in $beta0$.  -->
<!-- Note that several objects used in the computation of both numerator and J can be written as $\ü :* A$ or $\ü * A$, where $A$ is and $ü$ is .... All derivations are shown for the first case, while the main conclusions apply to the second as well.  -->
<!-- First, for the WCU, it holds that  -->
<!-- \begin{align} -->
<!--     \ü :* A &= (Y - X'\beta) :* A \\ -->
<!--       &= Y :* A - X'\beta :* A \\ -->
<!--       &= Y :* A - X'(X'X)^{-1}X Y :* A \\ -->
<!--       &=  ((1 :- P_{x}) Y) :* A  -->
<!-- \end{align} -->
<!-- For the WCR, the analogous derivation are slightly more complicated:  -->
<!-- \begin{align} -->
<!--   \tilde{u} :* A &= (Y_{r} - X_{r}'\beta_{r}) :* A \\ -->
<!--           &= Y_{r} :* A - X_{r}'\beta_{r} :* A \\ -->
<!--           &= Y_{r} :* A - X_{r}'(X_{r}'X_{r})^{-1}X_{r} Y_{r} :* A \\ -->
<!--           &= Y_{r} :* A - P_{xr} Y_{r} :* A \\ -->
<!-- \end{align} -->
<!-- Now, note that $Y_r = Y - X_0 r$, it follows that  -->
<!-- \begin{align} -->
<!--   \tilde{u} :* A &= Y_{r} :* A - P_{xr} Y_{r} :* A \\  -->
<!--             &= (Y - X_{0} r) :* A - P_{xr} (Y - X_{0} r) :* A \\ -->
<!--             &= Y :* A - X_{0} r :* A - (P_{xr} Y) :* A +  P_{xr}  X_{0} r :*A \\  -->
<!--             &=  Y :* A  - (P_{xr} Y) :* A - P_{xr}  X_{0} r :* A + X_{0} r :* A \\ -->
<!--             &= (Y - P_{xr} Y) :* A + (X_{0} r -P_{xr}  X_{0} r) :* A \\  -->
<!--             &= (1 :- P_{xr})Y :* A + ((1 :- P_{xr})  X_{0}) :* A * r \\ -->
<!--             &= P + Q r -->
<!-- \end{align} -->
<!-- where  -->
<!-- $$ -->
<!--   P = (1 :- P_{xr})Y -->
<!-- $$ -->
<!-- and  -->
<!-- $$ -->
<!--   Q = ((1 :- P_{xr})  X_{0}). -->
<!-- $$ -->
<!-- Both quantities, $P$ and $Q$, are explicitely computed as such in the boot_algo2 function. Q summarizes all terms that vary in $r$, while P summarizes constant terms.  -->
<!-- Note that in the case of the WCU, $X_r = X$, $P_{xr} = P_{x}$, and $X_0$ is a vector of length N, containing zeros.  -->
<!-- Therefore, the following quantities need to be computed:  -->
<!-- + $X_r$ -->
<!-- + $P_{xr}$ -->
<!-- + $X_0$ -->
<!-- + several different object for $A$ -->
<!-- Based on these objects, one can e.g. compute -->
<!-- \begin{align} -->
<!-- S_{c, c*}[\tilde{u} :* A] &= S_{c, c*}[(1 :- P_{xr})Y :* A] + S_{c, c*}[((1 :- P_{xr})  X_{0}) :* A]  r \\ -->
<!-- &= P_{1} + Q_{1} r -->
<!-- \end{align} -->
<!-- For K, one can then write an expression of the form  -->
<!-- \begin{align} -->
<!--   K &= (P_1 + P_2 + P_3) + (Q_1 + Q_2 +   Q_3) r  -->
<!-- \end{align} -->
<!-- For $J$, it follows that  -->
<!-- \begin{align} -->
<!--   J = K v & = (P_1 + P_2 + P_3) v + (Q_1 + Q_2 +   Q_3) v \times r \\ -->
<!--   &= C + D \times r -->
<!-- \end{align} -->
<!-- For $J :* J$, it hence follows  -->
<!-- $$ -->
<!--   J :* J = C :* C  + 2 C :* D \times r + D :* D \times r^{2} -->
<!-- $$ -->
<!-- So, in short: one can simply compute C, D, CC, CD and DD once and then invert the p-value by searching over beta0.  -->
<!-- Again, note that for for the WCU, $X_0 = 0$, which implies that in the equations above, all elements in $Q$, $Q1$, $Q2$, $Q3$, $D$, $CD$ and $DD$ are zero. In consequence, for the WCU, the numerator can be computed as  -->
<!-- $$ -->
<!-- $$ -->
<!-- and the denominator is  -->
<!-- $$ -->
<!-- $$ -->
<!-- For the WCU, both numerator and denominator do not depend on $r$. -->
<!-- + why might confidence intervals differ for estimates based on `lm()`, `feols()` and `felm()`? -->
</div>
<div id="small-sample-corrections" class="section level2">
<h2>Small Sample Corrections</h2>
<p><code>boottest()</code> adjust standard errors in case of multiway clustering via the formula <span class="math inline">\(N_{g} / (N_{g} - 1)\)</span>, where <span class="math inline">\(N_g\)</span> is the dimension of cluster g.</p>
</div>
<div id="treatment-of-invalid-test-statistics-for-multiway-clustering" class="section level2">
<h2>Treatment of Invalid Test Statistics for multiway clustering</h2>
<p>In case of multi-way clustering, it is not guaranteed that the covariance matrix is positive definite, in which case the resulting bootstrap test statistics are invalid. <code>boottest()</code> follows the implementation in STATA and deletes invalid tests statistics, and informs the user with a note.</p>
</div>
<div id="on-the-handling-of-missing-values" class="section level2">
<h2>On the handling of missing values</h2>
<p><code>boottest()</code> retrieves both the design matrix <span class="math inline">\(X\)</span>, the dependent variable <span class="math inline">\(y\)</span> and the cluster variables from the input object of type <code>lm</code>, <code>fixest</code> or <code>felm</code>. Because <code>boottest()</code> allows to add or delete clustering variables that are not employed in <code>lm()</code>, <code>feols()</code> and <code>felm()</code>, it may occurs that a cluster variable is added in <code>boottest()</code> that is not included in the regression model, either as a cluster variable or covariate. In this case, boottest deletes the respective rows in the dependent variable, design matrix and in the cluster variables. In consequence, estimation (in the modeling step) and inference (via <code>boottest()</code>) are done on a different sample. <code>boottest()</code> returns a warning.</p>
</div>
<div id="a-note-of-caution" class="section level2">
<h2>A note of caution</h2>
<p>The <code>feols()</code> function from <code>fixest</code> introduces several useful formula shortcuts. E.g. one can fit several regressions at once. All these advanced formula tools are not supported in <code>boottest()</code>. <code>boottest()</code> tries to catch any use of advanced formulas, but might fail to return errors in some cases.</p>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
